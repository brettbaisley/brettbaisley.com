---
---

<form action="#" method="post" id="contact-form">
    <div class="flex flex-col">
        <h3 class="text-4xl text-center">Contact Me</h3>

        <label for="name" class="mt-8">Name *</label>
        <input type="text" name="name" id="name" placeholder="John Doe" required autocomplete="given-name" class="p-4 rounded border-solid border-1 border-gray-700 bg-gray-800">

        <label for="email" class="mt-8">Email *</label>
        <input type="email" name="email" id="email" placeholder="john@doe.com" required autocomplete="off" class="p-4 rounded border-solid border-1 border-gray-700 bg-gray-800">
        
        <label for="message" class="mt-8">Message *</label>
        <textarea name="message" id="message" cols="30" rows="6" required class="p-4 rounded border-solid border-1 border-gray-700 bg-gray-800"></textarea>
        
        <p id="contact-form-status" class=""></p>

        <div>
            <button id="submit" class="mt-8 p-4 rounded bg-blue-500 cursor-pointer" type="submit">Send Message</button>
            <button id="resetButton" class="mt-8 p-4 rounded border border-1 border-blue-500 cursor-pointer" type="reset">Clear</button>
        </div>
    </div>
</form>

<script>
    // Add EventListener to clear status messages
    const clearFormButton = document.getElementById("resetButton");
    clearFormButton.addEventListener('click', event => {
        document.getElementById("contact-form-status").innerText = "";
        document.getElementById("contact-form-status")?.classList.remove("border","border-1","border-green-500","border-red-500","rounded-xl","p-4","bg-green-900","bg-red-900","text-green-400","text-red-400","mt-8");
    });
    
    // Add EventListener to trigger when submitting form
    const contactForm = document.getElementById("contact-form");
    contactForm.addEventListener('submit', event => {
        event.preventDefault();
        document.getElementById("submit").disabled = true;
        submitForm();
    });

    async function submitForm() {
        const targetAPI = '/api/email';
        
        var formData = new URLSearchParams();
        formData.append('name', document.getElementById('name').value || "From Website");
        formData.append('email', document.getElementById('email').value || "unknown@user.com");
        formData.append('message', document.getElementById('message').value || "No message");

        try {
            const response = await fetch(targetAPI, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: formData.toString()
            });

            if (response.ok) {
                document.getElementById("contact-form-status").innerText = "Message sent successfully!";
                document.getElementById("contact-form-status")?.classList.add("border","border-1","border-green-500","rounded-xl","p-4","bg-green-900","text-green-400","mt-8");
            } else {
                document.getElementById("contact-form-status").innerText = "Failed to send message.";
                document.getElementById("contact-form-status")?.classList.add("border","border-1","border-red-500","rounded-xl","p-4","bg-red-900","text-red-400","mt-8");
            }
        } catch (error) {
            document.getElementById("contact-form-status").innerText = "An error occurred.";
            document.getElementById("contact-form-status")?.classList.add("border","border-1","border-red-500","rounded-xl","p-4","bg-red-900","text-red-400","mt-8");
        } finally {
            document.getElementById("submit").disabled = false;
        }
    }
</script>